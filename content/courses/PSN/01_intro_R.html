---
title: "Introdução ao R"
author: "Amanda Yumi"
highlight: true
date: "2018-09-19"
output: html_document
type: book
weight: 20
---



<div id="introdução-ao-r---comandos" class="section level2">
<h2>Introdução ao R - comandos</h2>
<p>O R é um software importante para análise de dados estatísticos. Apesar de não ter uma interface gráfica , a usabilidade é melhor para personificação das análises e permite mais opções para visualização e análise de dados.</p>
<div id="vetor-e-matrizes-no-r" class="section level3">
<h3>Vetor e matrizes no R:</h3>
<p>Para armazenar um valor a uma variável, simplesmente usamos:</p>
<pre class="r"><code>x = 3.7</code></pre>
<p>O vetor é uma estrutura de dados básica do R, que permite armazenar um conjunto de valores numéricos ou de caractere sob um mesmo tipo.</p>
<pre class="r"><code>x = c(1, 2, 3, 4)
x</code></pre>
<pre><code>## [1] 1 2 3 4</code></pre>
<p>Para criar um vetor com repetidos valores, por exemplo uma repetição de zeros, utiliza-se:</p>
<pre class="r"><code>x = array(0, 100)
x</code></pre>
<pre><code>##   [1] 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
##  [38] 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
##  [75] 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0</code></pre>
<p>Para criar uma matriz, utiliza-se uma estrutura similar.</p>
<pre class="r"><code>x = matrix(1, 2, 2)
x</code></pre>
<pre><code>##      [,1] [,2]
## [1,]    1    1
## [2,]    1    1</code></pre>
<p>Atribuindo algum valor (1000) ao intervalo, no caso primeira linha:</p>
<pre class="r"><code>x[1,]=1000
# Saída da matriz inteira com 1000 na primeira linha e 1 no resto:
x</code></pre>
<pre><code>##      [,1] [,2]
## [1,] 1000 1000
## [2,]    1    1</code></pre>
<p>Caso queira exibir uma única linha ou coluna, basta digitar o comando com a linha ou coluna desejada:</p>
<pre class="r"><code># Coluna
x[,2]</code></pre>
<pre><code>## [1] 1000    1</code></pre>
<pre class="r"><code>#Linha:
x[2,]</code></pre>
<pre><code>## [1] 1 1</code></pre>
</div>
<div id="listas-no-r" class="section level3">
<h3>Listas no R:</h3>
<p>Listas são objetos que podem armazenar objetos de dados de tipos diferentes. É possível incluir data.frames, arrays, matrizes, vetores, fatores e mesmo listas em uma lista.</p>
<pre class="r"><code>list=list()
list$nome = &quot;joao&quot;
list$idade = 40
list$vetor=c(1,2,3)
list$nome</code></pre>
<pre><code>## [1] &quot;joao&quot;</code></pre>
<pre class="r"><code># Saída:
list</code></pre>
<pre><code>## $nome
## [1] &quot;joao&quot;
## 
## $idade
## [1] 40
## 
## $vetor
## [1] 1 2 3</code></pre>
</div>
<div id="loops-r" class="section level3">
<h3>Loops R:</h3>
<p>Para realizar uma repetição com variável de controle,
o comando for() incrementa um índice dentro de uma sequência de valores.</p>
<pre class="r"><code>for(i in 1:10){
  print (i)
}</code></pre>
<pre><code>## [1] 1
## [1] 2
## [1] 3
## [1] 4
## [1] 5
## [1] 6
## [1] 7
## [1] 8
## [1] 9
## [1] 10</code></pre>
<p>Para reaizar uma repetição pré-testada, o teste para sair do laço de repetição é realizado antes de entrar no laço, e para isso utilizamos a função while():</p>
<pre class="r"><code>i=1
while(i&lt;=10){
  print (i)
  i=i+1
}</code></pre>
<pre><code>## [1] 1
## [1] 2
## [1] 3
## [1] 4
## [1] 5
## [1] 6
## [1] 7
## [1] 8
## [1] 9
## [1] 10</code></pre>
<p>Ou outro exemplo:</p>
<pre class="r"><code>i=1
while(i&lt;=10){
  print (i)
  if (i&lt;=5) {
    print(&quot;menor ou igual a 5&quot;)
  }
  else{
    print(&quot;maior que 5&quot;)
  }
  i=i+1
}</code></pre>
<pre><code>## [1] 1
## [1] &quot;menor ou igual a 5&quot;
## [1] 2
## [1] &quot;menor ou igual a 5&quot;
## [1] 3
## [1] &quot;menor ou igual a 5&quot;
## [1] 4
## [1] &quot;menor ou igual a 5&quot;
## [1] 5
## [1] &quot;menor ou igual a 5&quot;
## [1] 6
## [1] &quot;maior que 5&quot;
## [1] 7
## [1] &quot;maior que 5&quot;
## [1] 8
## [1] &quot;maior que 5&quot;
## [1] 9
## [1] &quot;maior que 5&quot;
## [1] 10
## [1] &quot;maior que 5&quot;</code></pre>
<p>No R, o índice i for imutável, recomenda-se utilizar o “for” como opção de repetição.</p>
</div>
<div id="outras-funções-úteis-no-r" class="section level3">
<h3>Outras funções úteis no R:</h3>
<p>A Estatística Descritiva está diretamente ligada à organização e descrição dos dados. É utilizada para sumarizar como as observações se distribuem e onde estão posicionadas (ex.: medidas de tendência central e dispersão) e como se apresentam em termos de associação. Os conceitos e métodos descritivos são ponto de partida da análise exploratória de dados, passo fundamental para análises estatísticas mais avançadas.</p>
<p>Considerando a matriz criada x,</p>
<pre class="r"><code>x</code></pre>
<pre><code>##      [,1] [,2]
## [1,] 1000 1000
## [2,]    1    1</code></pre>
<p>temos as seguintes funções para estatística descritiva:</p>
<pre class="r"><code># Média:
mean(x)</code></pre>
<pre><code>## [1] 500.5</code></pre>
<pre class="r"><code># Desvio padrão 
sd(x)</code></pre>
<pre><code>## [1] 576.7729</code></pre>
<pre class="r"><code># Distribuição normal: 
rnorm(x)</code></pre>
<pre><code>## [1] -0.6034600  1.3594870  0.5426865 -0.5715408</code></pre>
<pre class="r"><code># Boxplot:
boxplot(x)</code></pre>
<p><img src="/courses/PSN/01_intro_R_files/figure-html/unnamed-chunk-11-1.png" width="672" /></p>
</div>
</div>
<div id="leitura-de-dados-de-ecg" class="section level2">
<h2>Leitura de dados de ECG</h2>
<p>A primeira vista, pode parecer contraintuitivo que num curso de Processamento de Sinais Neurais contenha análise de dados de Eletrocardiograma (ECG). Dentre os parâmetros que podem ser aferidos a partir do ECG é a frequência cardíaca (número de batimentos do coração que acontecem a cada minuto - bpm). A freqüência cardíaca é capaz de indicar uma ativação geral do sistema nervoso autônomo, responsável por controlar nossas reações corporais involuntárias. Ao expor uma pessoa em situações de maior demanda energética, o coração bate mais forte e mais rápido.</p>
<p>O uso do ECG fornece dados informativos acerca dos processos psicofisiológicos em diversas situações, sendo altamente aplicável em estudos que investigam as respostas comportamentais como por exemplo de consumidores ou outros entrevistados.</p>
<div id="leitura-de-dados-de-ecg-1" class="section level3">
<h3>Leitura de dados de ECG:</h3>
<p>Na aula o professor disponibilizou dados de um arquivo em que ele coletou dados de ECG de si mesmo (a partir de um arduino).
O arquivo contém uma única coluna que é o valor em mV coletado com o instrumento:</p>
<pre class="r"><code>dados = read.table(&quot;./data/ecg.txt&quot;, header = FALSE)</code></pre>
<p>Para visualizar os dados da forma de série temporal, utiliza-se a função ts.plot(). Algumas versões do R Studio contém um problema para visualização dos dados, então utiliza-se a seguinte gambiarra recomendada pelo Stackoverflow:</p>
<pre class="r"><code># Pra não dar erro &quot;figure margins too large&quot; no ts.plot:
graphics.off()
par(&quot;mar&quot;)</code></pre>
<pre><code>## [1] 5.1 4.1 4.1 2.1</code></pre>
<pre class="r"><code>par(mar=c(1,1,1,1))</code></pre>
<p>Após implementar essas linhas, na sequência, visualizamos os dados com a função:</p>
<pre class="r"><code># Plotando gráfico de linha - ECG
ts.plot(dados)</code></pre>
<p><img src="/courses/PSN/01_intro_R_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
<p>Um histograma pode ajudar a melhorar a visualização da amplitude do sinal:</p>
<pre class="r"><code>hist(dados$V1)</code></pre>
<p><img src="/courses/PSN/01_intro_R_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
<p>Para fins de referência, consideremos como picos de batimentos os valores com resultados acima de 685mV, então destacaríamos os maiores:</p>
<pre class="r"><code># Para percorrer todas as casas dos dados, detectando os picos:
picos=array(0, nrow(dados))
for(i in 1:960){
  if(dados$V1[i]&gt;685){
    picos[i]=1
  }
}

# Unindo no plot as colunas de dados e picos
ts.plot(cbind(dados$V1, picos))</code></pre>
<p><img src="/courses/PSN/01_intro_R_files/figure-html/unnamed-chunk-16-1.png" width="672" /></p>
<pre class="r"><code># Como pode ver, ficou zoado, então ajustamos a escala e adicionamos cores para que se possa visualizar os dados:
# cores: col 2 = preto e 1 vermelho
ts.plot(cbind(dados$V1, picos+684), col=c(2,1))</code></pre>
<p><img src="/courses/PSN/01_intro_R_files/figure-html/unnamed-chunk-16-2.png" width="672" /></p>
<p>O ajuste ainda não ficou muito claro. Toda vez que encontrar um pico, os valores conseguintes referem-se ao mesmo pico, ou seja, devemos limpar os dados (retirada de picos contínuos adjacentes).
Neste caso, escolhemos ignorar os picos dos 10 dados seguintes ao primeiro pico.</p>
<p>Nota: Para percorrer o vetor completo, basta percorrer o código até os 10 últimos (critério de parada) dados. Os demais picos seriam ignorados de qualquer forma e poderia reproduzir erro no vetor.</p>
<p>Dessa forma, teríamos:</p>
<pre class="r"><code>for(i in 1:(nrow(dados)-10) ){
  if(picos[i]==1){
    picos[(i+1):(i+10)]=0 
  }
}
ts.plot(cbind(dados$V1,picos+684),col=c(2,1))</code></pre>
<p><img src="/courses/PSN/01_intro_R_files/figure-html/unnamed-chunk-17-1.png" width="672" /></p>
</div>
</div>
